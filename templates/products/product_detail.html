{% extends "base.html" %}
{% load static %}

{% block title %}
    {{ product.name|default:"Pagina Prodotto" }} - ShopEasy
{% endblock title %}

{% block content %}
    <div class="container my-5">
        <div class="row">
            <!-- Colonna Sinistra: Galleria Immagini Prodotto -->
            <div class="col-lg-6">
                <div class="mb-3">
                    <img id="mainProductImage" src="{{ product.main_image.url|default:'https://placehold.co/600x600/eee/333?text=Immagine+Prodotto' }}" class="img-fluid rounded border w-100" alt="{{ product.name }}">
                </div>
                <!-- Thumbnails - Aggiungi altre immagini del prodotto se disponibili -->
                <div class="row g-2">
                    <div class="col-3">
                        <img src="{{ product.main_image.url|default:'https://placehold.co/150x150/eee/333?text=Thumb+1' }}" class="img-thumbnail" alt="Thumbnail 1" onclick="changeImage(this.src)">
                    </div>
                    <div class="col-3">
                        <img src="https://placehold.co/150x150/ddd/333?text=Thumb+2" class="img-thumbnail" alt="Thumbnail 2" onclick="changeImage(this.src)">
                    </div>
                    <div class="col-3">
                        <img src="https://placehold.co/150x150/ccc/333?text=Thumb+3" class="img-thumbnail" alt="Thumbnail 3" onclick="changeImage(this.src)">
                    </div>
                    <div class="col-3">
                        <img src="https://placehold.co/150x150/bbb/333?text=Thumb+4" class="img-thumbnail" alt="Thumbnail 4" onclick="changeImage(this.src)">
                    </div>
                </div>
            </div>

            <!-- Colonna Destra: Dettagli Prodotto e Azioni -->
            <div class="col-lg-6">
                <h1 class="display-5 fw-bold">{{ product.name|default:"Nome Prodotto Esempio" }}</h1>
                <p class="text-muted">
                    In <a href="#">{{ product.category.name|default:"Categoria" }}</a>
                </p>
                <p class="fs-3 fw-bold text-primary my-3">€{{ product.price|default:"99.99" }}</p>
                <p class="lead">{{ product.short_description|default:"Breve descrizione del prodotto che ne evidenzia le caratteristiche principali in poche frasi." }}</p>

                <hr>

                <!-- Form per Aggiungere al Carrello -->
                <form method="post" action="#">
                    {% csrf_token %}
                    <div class="row g-3 align-items-center">
                        <div class="col-md-4">
                            <label for="quantity" class="form-label">Quantità:</label>
                            <input type="number" id="quantity" name="quantity" class="form-control" value="1" min="1" max="10">
                        </div>
                        <div class="col-md-8">
                            <a href="{% url 'cart_add' product.id %}" class="btn btn-success btn-lg w-100 mt-md-4">
                                <i class="fas fa-cart-plus me-2"></i>Aggiungi al Carrello
                            </a>
                        </div>
                    </div>
                </form>

                <hr>

                <!-- Pulsanti di Condivisione Social -->
                <div class="mt-4">
                    <strong>Condividi:</strong>
                    <a href="#" class="btn btn-outline-secondary btn-sm ms-2"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="btn btn-outline-secondary btn-sm"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="btn btn-outline-secondary btn-sm"><i class="fab fa-pinterest-p"></i></a>
                    <a href="#" class="btn btn-outline-secondary btn-sm"><i class="fas fa-envelope"></i></a>
                </div>
            </div>
        </div>

        <!-- Sezione Dettagli Aggiuntivi (Descrizione, Specifiche, Recensioni) -->
        <div class="row mt-5">
            <div class="col-12">
                <ul class="nav nav-tabs" id="productDetailsTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab" aria-controls="description" aria-selected="true">Descrizione</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="specs-tab" data-bs-toggle="tab" data-bs-target="#specs" type="button" role="tab" aria-controls="specs" aria-selected="false">Specifiche Tecniche</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" aria-controls="reviews" aria-selected="false">Recensioni</button>
                    </li>
                </ul>
                <div class="tab-content p-4 border border-top-0" id="productDetailsTabContent">
                    <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
                        <p>{{ product.description|linebreaks|default:"Qui va la descrizione completa e dettagliata del prodotto. Può includere paragrafi multipli per spiegare i benefici, i materiali, e le modalità d'uso, offrendo al cliente tutte le informazioni necessarie per un acquisto consapevole." }}</p>
                    </div>
                    <div class="tab-pane fade" id="specs" role="tabpanel" aria-labelledby="specs-tab">
                        <table class="table table-striped">
                            <tbody>
                            <tr>
                                <th scope="row">Peso</th>
                                <td>{{ product.weight|default:"1.2 kg" }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Dimensioni</th>
                                <td>{{ product.dimensions|default:"25 x 15 x 10 cm" }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Materiale</th>
                                <td>{{ product.material|default:"Acciaio Inox e Plastica ABS" }}</td>
                            </tr>
                            <tr>
                                <th scope="row">Colore</th>
                                <td>{{ product.color|default:"Nero" }}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                        <p class="text-center">Qui verranno mostrate le recensioni dei clienti.</p>
                        <!-- Esempio di recensione -->
                        <div class="border-bottom pb-3 mb-3">
                            <strong>Mario Rossi</strong> - <small class="text-muted">1 settimana fa</small>
                            <div class="text-warning">
                                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
                            </div>
                            <p>Ottimo prodotto, esattamente come descritto. La spedizione è stata velocissima!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sezione Prodotti Correlati -->
        <div class="row mt-5">
            <div class="col-12">
                <h2 class="text-center mb-4">Potrebbe interessarti anche</h2>
                <div class="row g-4">
                    {# Esempio di loop per prodotti correlati #}
                    {% for i in "1234" %}
                        <div class="col-lg-3 col-md-6">
                            <div class="card h-100 text-center shadow-sm">
                                <img src="https://placehold.co/300x300/f8f9fa/333?text=Prodotto+{{i}}" class="card-img-top p-3" alt="Prodotto Correlato">
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title">Prodotto Correlato {{i}}</h5>
                                    <p class="card-text fw-bold text-primary fs-5 mt-auto">€49.99</p>
                                    <a href="#" class="btn btn-outline-primary w-100">Vedi Dettagli</a>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block footer_js %}
    <script>
        // Semplice script per cambiare l'immagine principale al click sulla thumbnail
        function changeImage(src) {
            document.getElementById('mainProductImage').src = src;
        }
    </script>
{% endblock footer_js %}
